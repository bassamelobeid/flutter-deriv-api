[EN]

# Generic rules
# - virtual account can only upgrade once to real account
# - Real account cannot open new account if previous account
#   currency is not set
# - Real account allowed only one fiat currency
# - Real new account cannot have same currency as existing
#   account
# - Real new account can have only each type of crypto
#   currency, if crypto currency is allowed by landing company
#   for e.g. BTC -> ETH allowed, BTC -> BTC not allowed

######
# CR
######

# CR specific rules
# - CR client not allowed to open maltainvest or japan account

# VIRTUAL ACCOUNT OPENING
verify_email/test_send.json,verify_email/test_receive.json, 'testmultiple@binary.com', 'account_opening'
new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('testmultiple@binary.com'), 'testmultiple@binary.com', 'id'
authorize/test_send.json,authorize/test_receive_vrtc.json,_get_stashed('new_account_virtual/new_account_virtual/oauth_token'), 'testmultiple@binary.com'
# not allowed to make virtual account with same email
!new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('testmultiple@binary.com'), 'testmultiple@binary.com', 'id'

# VRTC not allowed to open japan real account, only VRTJ allowed
!new_account_japan/test_send.json,new_account_japan/test_receive.json, 'Susan'
# REAL ACCOUNT OPENING
new_account_real/test_send.json,new_account_real/test_receive_cr.json, 'Howdee', 'id'

# placeholder to store token
|placeholder=_get_stashed('new_account_real/new_account_real/oauth_token')|

# virtual client not allowed to make multiple real account call
!new_account_real/test_send.json,new_account_real/test_receive_cr.json, 'Howdee', 'id'

# authorize real account to make multiple accounts
authorize/test_send.json,authorize/test_receive_cr.json,placeholder,'testmultiple@binary.com','Howdee'
payout_currencies/test_send.json,payout_currencies/test_receive_vrt.json, '(USD|EUR|GBP|AUD|BTC|LTC|ETH)', 7
# will fail as currency for existing client is not set
!new_account_real/test_send.json,new_account_real/test_receive_cr.json, 'Howdee', 'id'

# set account currency
set_account_currency/test_send.json,set_account_currency/test_receive.json, 'USD'
payout_currencies/test_send.json,payout_currencies/test_receive_vrt.json, 'USD', 1

# another account can be made, and any provided client data will be ignore
new_account_real/test_send_placeholder.json,new_account_real/test_receive_cr.json, 'Howde', 'Pann', '1980-11-31', 'id', 'Jakarta', '+612345678'
get_settings/test_send.json,new_account_real/test_recieve_get_settings.conf,

# allowed to make mutliple call now as currency is set for existing account
authorize/test_send.json,authorize/test_receive_cr.json,_get_stashed('new_account_real/new_account_real/oauth_token'),'testmultiple@binary.com','Howdee'

# will fail as USD already set for one of client
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'USD'
# we only allow one fiat currency so this will also fail
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'EUR'
# will fail as accounts exhausted
!new_account_real/test_send.json,new_account_real/test_receive_cr.json, 'Howdee', 'id'

# fail to set currency not in allowed currencies for landing company
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'ETC'
# ok to set BTC
set_account_currency/test_send.json,set_account_currency/test_receive.json, 'BTC'
# not allowed to set currency again
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'USD'

# not allowed to make maltainvest as new sibling
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'Howdee', 'dk'
# not allowed to make japan as new sibling
!new_account_japan/test_send.json,new_account_japan/test_receive.json, 'Susan'

logout/test_send.json,logout/test_receive.json

######
# MLT
######

# MLT specific rules
# - MLT can only upgrade to financial once
# - MLT can have currencies irrespective of what MF has
#   as checks are landing company specific

# VIRTUAL ACCOUNT OPENING
verify_email/test_send.json,verify_email/test_receive.json, 'test-multiple-mlt@binary.com', 'account_opening'
new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('test-multiple-mlt@binary.com'), 'test-multiple-mlt@binary.com', 'dk'
authorize/test_send.json,authorize/test_receive_vrtc.json,_get_stashed('new_account_virtual/new_account_virtual/oauth_token'), 'test-multiple-mlt@binary.com'

new_account_real/test_send.json,new_account_real/test_receive_mlt.json, 'Howdee', 'dk'
|placeholder=_get_stashed('new_account_real/new_account_real/oauth_token')|

# virtual not allowed to make multiple new accounts
!new_account_real/test_send.json,new_account_real/test_receive_mlt.json, 'Howdee', 'dk'
authorize/test_send.json,authorize/test_receive_mlt.json,placeholder, 'test-multiple-mlt@binary.com', 'Howdee'
payout_currencies/test_send.json,payout_currencies/test_receive_vrt.json, '(USD|EUR|GBP)', 3

# not allowed as previous account has no currency set
!new_account_real/test_send.json,new_account_real/test_receive_mlt.json, 'Howdee', 'dk'

# not allowed as not supported yet
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'LTC'
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'ETH'
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'BTC'
# set account currency
set_account_currency/test_send.json,set_account_currency/test_receive.json, 'EUR'
payout_currencies/test_send.json,payout_currencies/test_receive_vrt.json, 'EUR', 1

# still not allowed as fiat currency exhausted and MLT has no cryptocurrency
!new_account_real/test_send.json,new_account_real/test_receive_mlt.json, 'Howdee', 'dk'

new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive_error.json, '0', 'Howdee', 'dk'
# mlt able to upgrade to maltainvest
new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'Howdee', 'dk'

|placeholder=_get_stashed('new_account_maltainvest/new_account_maltainvest/oauth_token')|

# not allowed to create mutlpile invest account from mlt
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'Howdee', 'dk'

authorize/test_send.json,authorize/test_receive_mf.json,placeholder, 'test-multiple-mlt@binary.com', 'Howdee'

# not able to create as previous currency not set
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'Howdee', 'dk'
# able to set currency, doesn't depend on mlt account
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'LTC'
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'BTC'
set_account_currency/test_send.json,set_account_currency/test_receive.json, 'EUR'

# not able to create as fiat currency exhausted and crypto not yet supported for MF
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'Howdee', 'dk'
logout/test_send.json,logout/test_receive.json

{reset}

######
# MF
######

verify_email/test_send.json,verify_email/test_receive.json, 'test-multiple-mf@binary.com', 'account_opening'
new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('test-multiple-mf@binary.com'), 'test-multiple-mf@binary.com', 'de'
authorize/test_send.json,authorize/test_receive_vrtc.json,_get_stashed('new_account_virtual/new_account_virtual/oauth_token'), 'test-multiple-mf@binary.com'

# for germany we don't have gaming company so it should fail
!new_account_real/test_send.json,new_account_real/test_receive_mlt.json, 'MFName', 'de'

new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'MFName', 'de'
|placeholder=_get_stashed('new_account_maltainvest/new_account_maltainvest/oauth_token')|

# not allowed multiple upgrade from financial
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'MFName', 'de'

authorize/test_send.json,authorize/test_receive_mf.json,placeholder, 'test-multiple-mf@binary.com', 'MFName'

# not allowed as currency not set for existing account
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'MFName', 'de'

!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'BTC'
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'LTC'
set_account_currency/test_send.json,set_account_currency/test_receive.json, 'EUR'

# still not allowed as all accounts exhausted
!new_account_maltainvest/test_send.json,new_account_maltainvest/test_receive.json, '1', 'MFName', 'de'

#####
# MX
#####

# VIRTUAL ACCOUNT OPENING FOR (MX)
verify_email/test_send.json,verify_email/test_receive.json, 'test-multiple-mx@binary.com', 'account_opening'
new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('test-multiple-mx@binary.com'), 'test-multiple-mx@binary.com', 'gb'
authorize/test_send.json,authorize/test_receive_vrtc.json,_get_stashed('new_account_virtual/new_account_virtual/oauth_token'), 'test-multiple-mx@binary.com'
!new_account_virtual/test_send.json,new_account_virtual/test_receive.json,_get_token('test-multiple-mx@binary.com'), 'test-multiple-mx@binary.com', 'gb'

# REAL ACCOUNT OPENING (MX)

new_account_real/test_send.json,new_account_real/test_receive_mx.json, 'Johny', 'gb'
|placeholder=_get_stashed('new_account_real/new_account_real/oauth_token')|

# not allowed to open it again from virtual
!new_account_real/test_send.json,new_account_real/test_receive_mx.json, 'Johny', 'gb'

# authorize real account to make multiple accounts
authorize/test_send.json,authorize/test_receive_mx.json,placeholder, 'test-multiple-mx@binary.com', 'Johny'

# will fail as currency for existing client is not set
!new_account_real/test_send.json,new_account_real/test_receive_mx.json, 'Johny', 'gb'

# crypto currencies not allowed
!set_account_currency/test_send.json,set_account_currency/test_receive.json, 'BTC'

set_account_currency/test_send.json,set_account_currency/test_receive.json, 'GBP'
payout_currencies/test_send.json,payout_currencies/test_receive_vrt.json, 'GBP', 1

# will fail as exhausted
!new_account_real/test_send.json,new_account_real/test_receive_mx.json, 'Johny', 'gb'

{reset}

#####
# JP
#####

verify_email/test_send.json,verify_email/test_receive.json, 'test-multiple-jp2@binary.com', 'account_opening'
new_account_virtual/test_send.json,new_account_virtual/test_receive_vrtj.json,_get_token('test-multiple-jp2@binary.com'), 'test-multiple-jp2@binary.com', 'jp'
authorize/test_send.json,authorize/test_receive_vrtj.json,_get_stashed('new_account_virtual/new_account_virtual/oauth_token'), 'test-multiple-jp2@binary.com'

# REAL ACCOUNT OPENING (JP)
# this will be disabled account as for japan cs needs to remove
# activation pending so should still come as siblings
new_account_japan/test_send.json,new_account_japan/test_receive.json, 'Julie'
|placeholder=_get_stashed('new_account_japan/new_account_japan/oauth_token')|

# not allowed to create real from virtual again and already created one
# even though its disabled
!new_account_japan/test_send.json,new_account_japan/test_receive.json, 'Julie'

jp_knowledge_test/test_send.json,jp_knowledge_test/test_receive.json, '12', 'pass'

authorize/test_send.json,authorize/test_receive_jp_error.json,placeholder, 'test-multiple-jp2@binary.com', 'Julie'
