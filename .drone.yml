kind: pipeline
type: docker
name: syntax

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: syntax
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make syntax

---
kind: pipeline
type: docker
name: unit

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: Prepare repos
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit

---
kind: pipeline
type: docker
name: product_contract

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: product contract test
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_product_contract

---
kind: pipeline
type: docker
name: product_contract_settlement

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: product contract settlement test
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_product_contract_settlement

---
kind: pipeline
type: docker
name: product_contract_extended

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: product contract extended test
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_product_contract_extended

---
kind: pipeline
type: docker
name: validation

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: validation test
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_validation

---
kind: pipeline
type: docker
name: pricing

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: pricing test
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_pricing

---
kind: pipeline
type: docker
name: product_except_validation_contract_pricing

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: product except validation contract pricing
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - /opt/ci/run.sh make unit_test_product_except_validation_contract_pricing

---
kind: pipeline
type: docker
name: benchmark_merlin

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: benchmark merlin
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - . /opt/ci/setenv_prepare.sh
  - cd /home/git/regentmarkets/bom-quant-benchmark
  - /opt/circle/start_services
  - /opt/circle/check_services
  - make merlin_benchmark

---
kind: pipeline
type: docker
name: benchmark_OVRA

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: benchmark OVRA
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - . /opt/ci/setenv_prepare.sh
  - cd /home/git/regentmarkets/bom-quant-benchmark
  - /opt/circle/start_services
  - /opt/circle/check_services
  - make OVRA_benchmark

---
kind: pipeline
type: docker
name: benchmark_SDFC_SDEQ

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: benchmark SDFC SDEQ
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - . /opt/ci/setenv_prepare.sh
  - cd /home/git/regentmarkets/bom-quant-benchmark
  - /opt/circle/start_services
  - /opt/circle/check_services
  - make SDFX_benchmark_major
  - make SDFX_benchmark_minor
  - make SDEQ_benchmark_OTC_DJI
  - make SDEQ_benchmark_OTC_FCHI
  - make SDEQ_benchmark_OTC_SPC
  - make SDEQ_benchmark_SSECOMP
  - make SDEQ_benchmark_OTC_FTSE

---
kind: pipeline
type: docker
name: perl-Pricing-Engine-Tests

clone:
  disable: true

image_pull_secrets:
- dockerconfig

steps:
- name: Prepare repos
  image: regentmarkets/drone-git
  pull: always
  settings:
    ssh_key:
      from_secret: ssh_key
  commands:
  - . /opt/ci/setenv_prepare.sh
  - cd /home/git/regentmarkets/perl-Pricing-Engine-European-Digital-Slope
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-BlackScholes
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-Digits
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-HighLow-Ticks
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-Intraday-Forex-Base
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-Lookback
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-Markup
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-Reset
  - make test
  - cd /home/git/regentmarkets/perl-Pricing-Engine-TickExpiry
  - make test
