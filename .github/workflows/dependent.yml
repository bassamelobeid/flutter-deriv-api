name: Dependent Tests

on:
  workflow_call:
jobs:
  check_if_dependent_PR_exists:
    runs-on: ubuntu-latest
    outputs:
      result: ${{ steps.is_dependent_PR_exists.outputs.result }}
    steps:
      - name: check if dependent PR exists
        id: is_dependent_PR_exists
        uses: regentmarkets/github-actions/check-dependent-RP@master
        with:
          GH_TOKEN: ${{ secrets.CI_PR_LIST }}
          DT_list: 'bom-rpc binary-websocket-api bom-backoffice bom-user'
  bom-rpc:
    needs: check_if_dependent_PR_exists
    if: ${{ !contains(fromJSON(needs.check_if_dependent_PR_exists.outputs.result), 'bom-rpc') }}
    uses: regentmarkets/bom-rpc/.github/workflows/base.yml@master
    secrets: inherit
  binary-websocket-api:
    needs: check_if_dependent_PR_exists
    if: ${{ !contains(fromJSON(needs.check_if_dependent_PR_exists.outputs.result), 'binary-websocket-api') }}
    uses: regentmarkets/binary-websocket-api/.github/workflows/base.yml@master
    secrets: inherit
  bom-backoffice:
    needs: check_if_dependent_PR_exists
    if: ${{ !contains(fromJSON(needs.check_if_dependent_PR_exists.outputs.result), 'bom-backoffice') }}
    uses: regentmarkets/bom-backoffice/.github/workflows/base.yml@master
    secrets: inherit
  bom-user:
    needs: check_if_dependent_PR_exists
    if: ${{ !contains(fromJSON(needs.check_if_dependent_PR_exists.outputs.result), 'bom-user') }}
    uses: regentmarkets/bom-user/.github/workflows/base.yml@master
    secrets: inherit
